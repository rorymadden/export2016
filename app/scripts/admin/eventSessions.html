<h1>EventSessions <button class="btn btn-success" ng-click="adminEventSessions.addEventSession()"><i class="glyphicon glyphicon-plus"></i></button></h1>

<form ng-submit="adminEventSessions.createOrUpdate()" class="form-horizontal" name="adminEventSessions.eventSessionForm" ng-if="adminEventSessions.showEventSessionForm">
  <div class="alert alert-danger" role="alert" ng-if="adminEventSessions.formError">
    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
    <span class="sr-only">Error:</span>
    There was a problem with the form. Please try again.
  </div>

  <div class="form-group" ng-class="{'has-error': adminEventSessions.eventSessionForm.name.$invalid && adminEventSessions.eventSessionForm.name.$dirty}">
    <label for="name" class="col-sm-2 control-label">Name*</label>
    <div class="col-sm-10">
      <input type="string" class="form-control input-lg" id="name" ng-model="adminEventSessions.eventSession.name" required="">
    </div>
  </div>
  <div ng-messages="adminEventSessions.eventSessionForm.name.$error" style="color:maroon" role="alert">
    <div ng-message="required" class="help-block">You must enter a name</div>
  </div>


  <div class="form-group" ng-class="{'has-error': adminEventSessions.eventSessionForm.description.$invalid && adminEventSessions.eventSessionForm.description.$dirty}">
    <label for="description" class="col-sm-2 control-label">Description*</label>
    <div class="col-sm-10">
      <textarea class="form-control" rows="5" id="description" ng-model="adminEventSessions.eventSession.description" required=""></textarea>
    </div>
  </div>
  <div ng-messages="adminEventSessions.eventSessionForm.description.$error" style="color:maroon" role="alert">
    <div ng-message="required" class="help-block">You must enter a description </div>
  </div>


  <div class="form-group" ng-class="{'has-error': adminEventSessions.eventSessionForm.start.$invalid && adminEventSessions.eventSessionForm.start.$dirty}">
    <label for="start" class="col-sm-2 control-label">Start Date*</label>
    <div class="col-sm-10">
      <input type="datetime-local" class="form-control input-lg" id="start" ng-model="adminEventSessions.startDate" required="">
    </div>
  </div>
  <div ng-messages="adminEventSessions.eventSessionForm.start.$error" style="color:maroon" role="alert">
    <div ng-message="required" class="help-block">You must enter a start date</div>
  </div>

  <div class="form-group" ng-class="{'has-error': adminEventSessions.eventSessionForm.end.$invalid && adminEventSessions.eventSessionForm.end.$dirty}">
    <label for="end" class="col-sm-2 control-label">End Date*</label>
    <div class="col-sm-10">
      <input type="datetime-local" class="form-control input-lg" id="end" ng-model="adminEventSessions.endDate" required="">
    </div>
  </div>
  <div ng-messages="adminEventSessions.eventSessionForm.end.$error" style="color:maroon" role="alert">
    <div ng-message="required" class="help-block">You must enter an end date</div>
  </div>


  
  <div class="form-group" ng-class="{'has-error': adminEventSessions.partnerForm.stream.$invalid && adminEventSessions.partnerForm.stream.$dirty}">
    <label for="stream" class="col-sm-2 control-label">Stream</label>
    <div class="col-sm-10">
      <select class="form-control input-lg" ng-model="adminEventSessions.streamOption.objectId" ng-options="stream.objectId as stream.name for stream in adminEventSessions.streams | filter:{active:true}">
        <option value="">-- Select a Stream --</option>
      </select>
    </div>
  </div>


  <div class="form-group" ng-class="{'has-error': adminEventSessions.partnerForm.location.$invalid && adminEventSessions.partnerForm.location.$dirty}">
    <label for="location" class="col-sm-2 control-label">Location*</label>
    <div class="col-sm-10">
      <select class="form-control input-lg" ng-model="adminEventSessions.locationOption.objectId" ng-options="location.objectId as location.name for location in adminEventSessions.locations | filter:{active:true}" required="">
        <option value="">-- Select a Location --</option>
      </select>
    </div>
  </div>
  <div ng-messages="adminEventSessions.eventSessionForm.end.$error" style="color:maroon" role="alert">
    <div ng-message="required" class="help-block">You must enter a location</div>
  </div>

  <div class="form-group" ng-repeat="speaker in adminEventSessions.selectedSpeakers">
    <label for="speaker" class="col-sm-2 control-label"><span ng-show="$first">Speakers</span></label>
    <div class="col-sm-10">
      <select class="form-control input-lg" name="speaker" ng-model="speaker.objectId" ng-options="sp.objectId as sp.first + ' ' + sp.last for sp in adminEventSessions.speakers | filter:{active:true}" ng-change="adminEventSessions.addNewSpeaker(speaker)">
        <option value="">-- Select a Speaker --</option>
      </select>
     </div>
  </div>

  <button class="btn btn-lg btn-primary btn-block" type="submit" ng-disabled="adminEventSessions.eventSessionForm.$invalid || adminEventSessions.processing">Create / Update</button>

</form>

<table class="table table-striped" class="row-border hover">
    <thead>
<!--     <tr>
      <th colspan="5"><input st-search class="form-control" placeholder="global search ..." type="text"/></th>
    </tr> -->
    <tr>
        <th width="10%" ng-click="adminEventSessions.orderByField='name'; adminEventSessions.reverseSort = !adminEventSessions.reverseSort">Name <span ng-show="adminEventSessions.orderByField == 'name'"><span ng-show="!adminEventSessions.reverseSort">^</span><span ng-show="adminEventSessions.reverseSort">v</span></span></th>
        <th width="25%" ng-click="adminEventSessions.orderByField='description'; adminEventSessions.reverseSort = !adminEventSessions.reverseSort">Description <span ng-show="adminEventSessions.orderByField == 'description'"><span ng-show="!adminEventSessions.reverseSort">^</span><span ng-show="adminEventSessions.reverseSort">v</span></span></th>
        <th width="8%" ng-click="adminEventSessions.orderByField='start'; adminEventSessions.reverseSort = !adminEventSessions.reverseSort">Start <span ng-show="adminEventSessions.orderByField == 'start'"><span ng-show="!adminEventSessions.reverseSort">^</span><span ng-show="adminEventSessions.reverseSort">v</span></span></th>
        <th width="8%" ng-click="adminEventSessions.orderByField='end'; adminEventSessions.reverseSort = !adminEventSessions.reverseSort">End <span ng-show="adminEventSessions.orderByField == 'end'"><span ng-show="!adminEventSessions.reverseSort">^</span><span ng-show="adminEventSessions.reverseSort">v</span></span></th>
        <th width="15%" ng-click="adminEventSessions.orderByField='speakers'; adminEventSessions.reverseSort = !adminEventSessions.reverseSort">Speakers <span ng-show="adminEventSessions.orderByField == 'speakers'"><span ng-show="!adminEventSessions.reverseSort">^</span><span ng-show="adminEventSessions.reverseSort">v</span></span></th>
        <th width="5%" ng-click="adminEventSessions.orderByField='location'; adminEventSessions.reverseSort = !adminEventSessions.reverseSort">Location <span ng-show="adminEventSessions.orderByField == 'location'"><span ng-show="!adminEventSessions.reverseSort">^</span><span ng-show="adminEventSessions.reverseSort">v</span></span></th>
        <th width="14%" ng-click="adminEventSessions.orderByField='stream'; adminEventSessions.reverseSort = !adminEventSessions.reverseSort">Stream <span ng-show="adminEventSessions.orderByField == 'stream'"><span ng-show="!adminEventSessions.reverseSort">^</span><span ng-show="adminEventSessions.reverseSort">v</span></span></th>
        <th width="5%">Edit</th>
        <th width="5%">Action</th>
    </tr>
    </thead>
    <tbody>
    <tr ng-repeat="eventSession in adminEventSessions.eventSessions|orderBy:adminEventSessions.orderByField:adminEventSessions.reverseSort" ng-class="{'inactive': !eventSession.active}">
        <td>{{eventSession.name}}</td>
        <td>{{eventSession.description}}</td>
        <td>{{eventSession.start.iso | date: 'd/M/yy h:mm a': adminEventSessions.eventTimeZone}}</td>
        <td>{{eventSession.end.iso |  date: 'd/M/yy h:mm a': adminEventSessions.eventTimeZone}}</td>
        <td>{{eventSession.speakers | speakerNames}}</td>
        <td>{{eventSession.location.name}}</td>
        <td><span ng-if="eventSession.stream" ng-click="adminEventSessions.removeStream(eventSession)">{{eventSession.stream.name}}</span></td>
        <td><button class="btn btn-primary" ng-click="adminEventSessions.addEventSession(eventSession)"><i class="glyphicon glyphicon-pencil"></button></td>
        <td><button class="btn" ng-class="{'btn-danger': eventSession.active, 'btn-default': !eventSession.active}" ng-click="adminEventSessions.toggleEventSession(eventSession)"><i class="glyphicon" ng-class="{'glyphicon-remove': eventSession.active, 'glyphicon-ok': !eventSession.active}"></button></td>
    </tr>
    </tbody>
</table>
